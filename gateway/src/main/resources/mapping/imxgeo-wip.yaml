lineageNameMapping:
  hasLineage: geregistreerdMet
  ObjectLineage: Registratie
  orchestratedProperties: bestaatUit
  OrchestratedProperty: GeorkestreerdGegeven
  SourceProperty: Brongegeven
  ObjectReference: Object
  subject: onderwerp
  property: kenmerk
  value: waarde
  objectKey: identificatie
  objectType: type

namedPaths:
  plaats:
    path: ligtIn
    andThen:
      ifMatch:
        type: isNull
      path: ligtAan/ligtIn
    default: null # is default

#namedTransforms:
#  isNotEmpty:
#    expr: "value != null"
#  prefix:
#    if: "value != null"
#    expr: "args.str + value"
#    args:
#      str:
#        type: string

#pathMappings:
#  2a:
#    path: isBelastendVoor
#    repeat:
#      untilMatch:
#        type: notNull
#    andThen:
#      path: "{2b}"
#
#  2b:
#    path: isOntstaanUit/betrokkene
#    andThen:
#      path: "{2a}"
#      ifMatch:
#        type: notNull
#
#objectTypeMappings:
#  AppartementsrechtSplitsing:
#    sourceRoot: brk:AppartementsrechtsSplitsing
#    propertyMappings:
#      heeftGrondperceel:
#        path: "isBelastMet/{2a}/rustOp"

targetModel:
  imxgeo:
    location: "config/models/mimxml-imx-geo.xml"
    loader: mim

sourceModels:
  - bag:
      location: "config/models/imbag.xml"
      loader: mim
  - bgt:
      location: "config/models/imgeo.xml"
      loader: mim
  - bg:
      location: "config/models/bg.xml"
      loader: mim
  - imro:
      location: "config/models/imro.xml"
      loader: mim
  - brk:
      location: "config/models/brk.xml"
      loader: mim
  - bro:
      location: "config/models/bro.xml"
      loader: mim

objectTypeMappings:
  Adres:
    sourceRoot: bag:Nummeraanduiding
    propertyMappings:
      identificatie:
        pathMappings:
          path: identificatie
      # domein: TODO
      huisnummer:
        pathMappings:
          path: huisnummer
      huisnummertoevoeging:
        pathMappings:
          path: huisnummertoevoeging
      huisletter:
        pathMappings:
          path: huisletter
      postcode:
        pathMappings:
          path: postcode
      straatnaam:
        pathMappings:
          path: ligtAan/naam
      plaatsnaam:
        pathMappings:
          path: ligtIn/naam
          andThen:
            path: ligtAan/ligtIn/naam
            ifMatch:
              type: isNull
      isHoofdadres:
        pathMappings:
          path: isHoofdadresVan/identificatie
          map:
            type: cel
            options:
              expr: 'type(result) != null_type'
      omschrijving:
        pathMappings:
          - path: ligtAan/naam
          - path: huisnummer
            map:
              type: prepend
              options:
                prefix: ' '
          - path: huisletter
            map:
              type: prepend
              options:
                prefix: ' '
          - path: huisnummertoevoeging
            map:
              type: prepend
              options:
                prefix: '-'
          - path: postcode
            map:
              type: prepend
              options:
                prefix: ', '
          - path: ligtIn/naam
            andThen: # Moet dit een or worden?
              path: ligtAan/ligtIn/naam
              ifMatch:
                type: isNull
            map:
              type: prepend
              options:
                prefix: ' '
        combiner:
          type: join
      # TODO: auto-generatie inverse mappings
      isAdresVanGebouw:
        pathMappings:
          path: isHoofdadresVan/maaktDeelUitVan/isGerelateerdAan

  Gebouw:
    sourceRoot:
      - type: bgt:Pand
      - type: bgt:OverigBouwwerk
    propertyMappings:
      identificatie:
        pathMapping:
          path: identificatie
#      domein: NL.,,, # TODO
      bouwjaar:
        pathMapping:
          ifMatchType: bgt:Pand
          path: isGerelateerdAan/oorspronkelijkBouwjaar
      sloopjaar:
        pathMapping:
          ifMatchType: bgt:Pand
          path: isGerelateerdAan/status
          andThen:
            ifMatch:
              type: equals
              options:
                value: "Pand gesloopt"
            path: isGerelateerdAan/geregistreerdMet/beginGeldigheid
            map:
              type: cel
              options:
                expr: 'getFullYear(result)'
      bovenaanzichtgeometrie:
        pathMapping:
          ifMatchType: bgt:Pand
          path: isGerelateerdAan/geometrie
      maaiveldgeometrie:
        pathMappings:
          - ifMatchType: bgt:Pand
            path: geometrie2dGrondvlak
          - ifMatchType: bgt:OverigBouwwerk
            path: geometrie2dOverigeConstructie
      heeftAlsAdres:
        pathMappings:
          - ifMatchType: bgt:Pand
            path: isGerelateerdAan/bevat/heeftAlsHoofdadres
          - ifMatchType: bgt:Pand
            path: isGerelateerdAan/bevat/heeftAlsNevenadres
        combiner:
          type: merge
      totaalPerceelOppervlak:
        pathMappings:
          path: isGerelateerdAan/bevat/heeftAlsHoofdadres/betreftInverse/heeft/kadastraleGrootte
        combiner:
          type: sum
      bevindtZichOpPerceel:
        pathMappings:
          path: isGerelateerdAan/bevat/heeftAlsHoofdadres/betreftInverse/heeft

  Waterschap:
    sourceRoot: bg:Waterschap
    propertyMappings:
      identificatie:
        pathMapping:
          path: identificatie
#      domein:
      naam:
        pathMapping:
          path: officieleNaamInclSoort

  Waterschapsgebied:
    sourceRoot: bg:Waterschap
    propertyMappings:
      identificatie:
        pathMapping:
          path: identificatie
      # domein: TODO
      geometrie:
        pathMapping:
          path: geometrie
      wordtBestuurdDoorWaterschap:
        pathMapping:
          path: . # TODO

  Gemeente:
    sourceRoot: bg:Gemeente
    propertyMappings:
      identificatie:
        pathMapping:
          path: identificatie
      # domein: TODO
      naam:
        pathMapping:
          path: officieleNaamInclSoort

  Gemeentegebied:
    sourceRoot: bg:Gemeente
    propertyMappings:
      identificatie:
        pathMapping:
          path: identificatie
      # domein: TODO
      geometrie:
        pathMapping:
          path: geometrie
      wordtBestuurdDoorGemeente:
        pathMapping:
          path: . # Current path

  Bestemming:
    sourceRoot:
      - type: imro:Enkelbestemming
      - type: imro:Dubbelbestemming
    propertyMappings:
      identificatie:
        pathMappings:
          - path: identificate/namespace
          - path: identificatie/lokaalID
            map:
              type: prepend
              options:
                prefix: '.'
        combiner:
          type: join
      # domein: TODO
      bestemming:
        pathMapping:
          path: naam
      bestemmingsplan:
        pathMapping:
          path: plangebied.identificatie
      verwijzingNaarArtikel:
        pathMapping:
          path: verwijzingNaarTekstInfo/verwijzingNaarTekst
      geometrie:
        pathMapping:
          path: geometrie

  Perceel:
    sourceRoot: brk:Perceel
    propertyMappings:
      identificatie:
        pathMapping:
          path: identificatie
      # domein: TODO
      begrenzing:
        pathMapping:
          path: begrenzingPerceel
      beperking: # TODO
        pathMapping:
          path: grondslag
      oppervlak:
        pathMapping:
          path: kadastraleGrootte/waarde
      laatsteKoopsom:
        pathMapping:
          path: koopsom/bedrag/som
      koopjaar:
        pathMapping:
          path: koopsom/koopjaar
#      ligtInRegistratieveRuimte: # TODO sourceRelations
#        pathMapping:
#          path: ligtInRegistratieveRuimte
#      bevatBouwwerk: # TODO sourceRelations
#        pathMapping:
#          path: bevatBouwwerk
#      heeftBestemming: # TODO sourceRelations
#        pathMapping:
#          path: heeftBestemming

  Bedrag:
    propertyMappings:
      som:
        pathMapping:
          path: som
      valuta:
        pathMapping:
          path: valuta

  Woonplaats: # TODO is dit nodig? Woonplaats is 1 op 1
    sourceRoot: bag:Woonplaats
    propertyMappings:
      identificatie:
        pathMapping:
          path: identificatie
      # domein: TODO
      geometrie:
        pathMapping:
          path: geometrie
      naam:
        pathMapping:
          path: naam

  Wijk:
    sourceRoot: bgt:Wijk
    propertyMappings:
      identificatie:
        pathMapping:
          path: identificatie
      # domein: TODO
      geometrie:
        pathMapping:
          path: geometrie
      naam:
        pathMapping:
          path: naam
      wijkcode:
        pathMapping:
          path: wijkcode

  Buurt:
    sourceRoot: bgt:Buurt
    propertyMappings:
      identificatie:
        pathMapping:
          path: identificatie
      # domein: TODO
      geometrie:
        pathMapping:
          path: geometrie
      naam:
        pathMapping:
          path: naam
      buurtcode:
        pathMapping:
          path: buurtcode

  Bouwwerk:
    sourceRoot: # TODO
      - type: bgt:Tunneldeel
      - type: bgt:Kunstwerkdeel
      - type: bgt:Scheiding
      - type: bgt:Gebouwinstallatie
      - type: bgt:Overbruggingsdeel
    propertyMappings:
      identificatie:
        pathMappings:
          path: identificatie
      # domein: TODO
      maaiveldgeometrie:
        pathMappings:
          path: geometrie
      type:
        pathMappings:
#          - ifMatchType: bgt:Tunneldeel # TODO
#            constant: "Tunneldeel"
          - ifMatchType: bgt:Kunstwerkdeel
            path: plus-type
            andThen:
              ifMatch: isNull
              path: bgt-type
#          - ifMatchType: bgt:OverigeConstructie # TODO missing mapping
          - ifMatchType: bgt:GebouwInstallatie
            path: plus-type
            andThen:
              ifMatch:
                type: isNull
              path: bgt-type
          - ifMatchType: bgt:Overbruggingsdeel
            path: bgt:typeOverbruggingsdeel
          - ifMatchType: bgt:Paal
            path: plus-type
            andThen:
              ifMatch:
                type: isNull
              path: bgt-type
          - ifMatchType: bgt:Mast
            path: plus-type
            andThen:
              ifMatch:
                type: isNull
              path: bgt-type
          - ifMatchType: bgt:Straatmeubilair
            path: plus-type
            andThen:
              ifMatch:
                type: isNull
              path: bgt-type
          - ifMatchType: bgt:Put
            path: plus-type
            andThen:
              ifMatch:
                type: isNull
              path: bgt-type
          - ifMatchType: bgt:Bak
            path: plus-type
            andThen:
              ifMatch:
                type: isNull
              path: bgt-type
          - path: . # TODO
            map:
              type: objectType

  Landschapselement:
    sourceRoot: bgt:VegetatieObject
    propertyMappings:
      identificatie:
        pathMapping:
          path: identificatie
      # domein: TODO
      type:
        pathMapping:
          path: plus-type
          andThen:
            ifMatch:
              type: isNull
            path: bgt-type
      geometrie:
        pathMapping:
          path: geometrie

  Water:
    sourceRoot: bgt:Waterdeel
    propertyMappings:
      identificatie:
        pathMapping:
          path: identificatie
      # domein: TODO
      type:
        pathMapping:
          path: plus-type
          andThen:
            ifMatch:
              type: isNull
            path: bgt-type
      geometrie:
        pathMapping:
          path: geometrie
#      functie: # TODO missing mapping
#        pathMappping:
#      realiseertInfiltratie: # TODO missing mapping
#        pathMapping:

  Weg:
    sourceRoot: bgt:Wegdeel
    propertyMappings:
      identificatie:
        pathMapping:
          path: identificatie
      # domein: TODO
#      functie: # TODO missing mapping
#        pathMapping:
#          path:
      fysiekVoorkomen:
        pathMapping:
          path: plus-fysiekvoorkomen
          andThen:
            ifMatch:
              type: isNull
            path: bgt-fysiekvoorkomen
      geometrie:
        pathMapping:
          path: geometrie
#      naam: # TODO sourceRelation to BAG OpenbareRuimte
#        pathMapping:
#          path: <<link-to-bag:OpenbareRuimte>>/naam

#   Ondergrond: # TODO missing mapping

  Grondwaterstand:
    sourceRoot: bro:Grondwaterspiegeldieptemeting
    propertyMappings:
#      identificatie: # TODO missing mapping
#        pathMapping:
#          path: identificatie
      # domein: TODO
      geometrie:
        pathMapping:
          path: geometrie

  Bodemsamenstelling:
    sourceRoot: bro:Voxel
    propertyMappings:
      #      identificatie: # TODO missing mapping
      #        pathMapping:
      #          path: identificatie
      # domein: TODO
      geometrie:
        pathMapping:
          path: geometrie
